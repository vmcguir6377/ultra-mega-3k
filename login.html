<!DOCTYPE html>
<html lang="en">

<head>

  <title>Universal Contacts Registration</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />



  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/7.4.0/polyfill.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.1.1/exceljs.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.2/FileSaver.min.js"></script>
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <!-- Theme stylesheet -->
      <link href="https://cdnjs.cloudflare.com/ajax/libs/devextreme/21.2.6/css/dx.material.orange.dark.compact.css"
          rel="stylesheet">
      <script src="https://cdnjs.cloudflare.com/ajax/libs/devextreme/21.2.6/js/dx.all.js"></script>
  <script>

_APIURL = "http://10.0.0.16:8814/api/";

    function attemptLogin(){
      return new Promise((resolve,reject)=>{
          resolve();
          try {
        var settings = {
          "url": `${_APIURL}${endpoint}`,
          "method": "POST",
          "data": data,
          };
       
        $.ajax(settings).done(function (response) {
          resolve('success');
        }).fail((err) => reject(err))

          reject('login failed.')
        } catch (err) {
        cap.events.onError(err)
        reject(err)
      }
    },
    )}

      function ShowLogin() {
        if (typeof (_LoginPopup) !== "undefined") {
          _LoginPopup.show();
          return;
        }
        _LoginPopup = $('<div>').appendTo('body')
          .dxPopup({
            title: 'please login',
            visible: true,
            contentTemplate: (container) => {
              _LoginForm = $('<div>').appendTo(container)
                .dxForm({
                  formData: {},
                  items: [
                    {
                      dataField: 'emailAddress',
                      validationRules:[
                        {type:'required',message:"required field"},
                        {type:'email',message:'invalid email detected'}
                      ]
                    },
                    {
                      dataField: 'password',
                      editorOptions:{mode:'password'},
                      validationRules:[
                        {type:'required',message:"required field"}
                      ]
                    }
                  ]
                })
                .dxForm('instance')
            }
          ,
          toolbarItems: [ {
            widget: "dxButton",
            toolbar:'bottom',
            location: "after",
            options: { 
                text: "Submit", 
                icon:'key',
                type: "success",
                onClick:(e)=>{ 
                  attemptLogin()
                  .then(()=>{
                    document.location.href = 'index.html';
                  })
                  .catch((err)=>{
                    console.log(err);
                    DevExpress.ui.notify('invalid login attempt. please try again.','error',3000);
                  })


                 }
            }
        }]})
          .dxPopup('instance')
      }
      

    $(() => {
      ShowLogin();
    })

  </script>
</head>

<body class="dx-viewport">

<footer class="footer">
    <p>Â© 2022 United Locating Services</p>
  </footer>
</body>

</html>